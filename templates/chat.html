<!DOCTYPE html>
<html>
  <head>
    <title>Medical Chatbot</title>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <style>
      .chat-container {
        height: 500px;
        overflow-y: auto;
        background-color: #f7f7f7;
        padding: 20px;
        border-radius: 10px;
      }
      .user-msg {
        background-color: #007bff;
        color: white;
        padding: 10px;
        border-radius: 15px;
        margin: 5px;
        float: right;
        clear: both;
      }
      .bot-msg {
        background-color: #e4e6eb;
        color: black;
        padding: 10px;
        border-radius: 15px;
        margin: 5px;
        float: left;
        clear: both;
      }
    </style>
  </head>
  <body class="bg-light">
    <div class="container mt-5">
      <h2 class="text-center mb-4">ü©∫ Medical AI Assistant</h2>
      <div id="messageArea" class="chat-container border"></div>
      <form id="chatForm" class="mt-3">
        <div class="input-group">
          <input
            type="text"
            id="text"
            name="msg"
            placeholder="Ask a medical question..."
            class="form-control"
            required
          />
          <div class="input-group-append">
            <button type="submit" id="send" class="btn btn-primary">
              Send
            </button>
          </div>
        </div>
      </form>
    </div>

    <script>
      $(document).ready(function () {
        $("#chatForm").on("submit", function (event) {
          event.preventDefault();
          const userText = $("#text").val();

          // Append user message
          $("#messageArea").append(
            '<div class="user-msg">' + userText + "</div>"
          );
          $("#text").val("");

          // Append a temporary "Thinking..." message
          const thinkingId = "thinking-" + Date.now();
          $("#messageArea").append(
            '<div class="bot-msg" id="' +
              thinkingId +
              '">ü©∫ Assistant is thinking...</div>'
          );
          $("#messageArea").scrollTop($("#messageArea")[0].scrollHeight);

          $.ajax({
            data: { msg: userText },
            type: "POST",
            url: "/get",
          })
            .done(function (data) {
              // Remove the "Thinking..." message and add the real answer
              $("#" + thinkingId).remove();
              $("#messageArea").append(
                '<div class="bot-msg">' + data + "</div>"
              );
              $("#messageArea").scrollTop($("#messageArea")[0].scrollHeight);
            })
            .fail(function () {
              $("#" + thinkingId).text("‚ùå Error: Could not reach the server.");
            });
        });
      });
    </script>
  </body>
</html>
